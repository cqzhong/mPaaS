#### mPaaS手册


| 版本 | 0.0.1          |
| ---- | -------------- |
| 作者 | 刘乾           |
| 日期 | 2019年11月28日 |



##### 一次数据交互的过程

![请求与相应](D:\项目\pad\请求与相应.png)

#### 准备工作



1. 移动网关

   - **网关管理**

     **网关管理所有的API分组**，开启客户端与网关之间的签名校验和数据加密。进入控制台，左侧选择【后台服务管理】-【移动网关】，然后选择【网关管理】页面标签，将【签名校验】、【数据加密】后的开关打开，其中【数据加密】的开启需要在控制台自行配置密钥，此时可以保证**客户端的请求不被篡改和伪造**。

   - **创建API分组**

     **API分组管理该分组下所有的API**。进入控制台，左侧选择【后台服务管理】-【移动网关】，然后选择【API分组】页面标签，点击【创建API分组】按钮，按照提示依次填写【分组类型】【API分组名称】【服务地址】【超时时间】。

   - **配置API分组**

     新建的API分组后，点击【详情】进入API分组的配置页面，这可以对该分组下的API进行统一配置。如果该组API需要服务端验签，可以配置密钥并开启验签。开启验签可以保证**网关到服务端的请求不被篡改和伪造**

   - **创建API**

     在配置好API分组之后，新建API。进入控制台，左侧选择【后台服务管理】-【移动网关】，然后选择【API管理】页面标签，点击【创建API】按钮，然后填写【API类型】【添加方式】【operationType】。

     说明：

     ①HTTP类型的API接口，使用手动添加的方式 ②API 服务标识`operationType`是前端、客户端调用网关API的唯一标识、

   - **配置API**

     完成API创建后，会自动跳转到API配置页面，需要对其进行必要配置才能开启。必填信息做如下解释：

     【API名称】该API在控制台显示的名称  【接入系统】该API归属于哪个API分组

     【请求PATH】对应服务端API接口的url地址，类似于/index,可使用${}包含path参数，比如/pets/${id}

     【调用方式】网关调用服务端API接口使用的请求方法  【报文编码】报文传输的编码方式

     说明：

     ①高级配置中，默认按照API分组来开关签名校验，可以根据接口性质，单独对此API开关签名校验

     ②可以在缓存配置中配置需要缓存的键值，减少对服务端的请求次数

     ③在参数设置里面，可以设置请求参数和请求body及其默认值，方便API测试使用 

     ④mPaaS请求分为请求参数和请求Body两部分，请求参数对应RPC的**`requestData`**，请求Body对应**`requestData`**中的**`_requestBody`**参数

   - **API测试**

     ![1574931086855](C:\Users\liuqian2\AppData\Roaming\Typora\typora-user-images\1574931086855.png)

     可以开启API MOCK，或者当后端开发好接口，使用API Test功能进行测试。进入控制台，左侧选择【后台服务管理】-【移动网关】，然后选择【API管理】页面标签，点击API名称后面的【操作-更多-API Test】按钮，【请求路径】写`https://cn-hangzhou-mgs-gw.cloud.alipay.com/mgw.htm`，【请求参数】根据需要填写（参数说明参考【配置API】的说明④）。

   - **以上是梳理出来需要在移动网关的进行的工作流程，其余操作均在此基础之上，更多操作与说明参考[mPaaS开发文档-移动网关](https://tech.antfin.com/docs/2/49552)**

2. 客户端

   * 

3. 服务端

   * 

